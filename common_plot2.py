import numpy as np
import matplotlib.pyplot as plt

def plot_mackey(H_lol, optimal_q_list, optimal_H_list, true_list):
    # H_values_mackey_17_1 = [0.2887631449351124, 0.2877758713642961, 0.28683775304450776, 0.28601421448327513, 0.2851852669356111, 0.28436633520520765, 0.28353683655939943, 0.2826914063006998, 0.28183184745564877, 0.2809533696882219, 0.28006450988277237, 0.2791667026562684, 0.2782546604396615, 0.27733283470396963, 0.2764004698243641, 0.2754592436932236, 0.27450934607676836, 0.2735502185724154, 0.2725798635224196, 0.27160094192467654, 0.27061321167249325, 0.26961802644342525, 0.2686154944228409, 0.26760521672780474, 0.266586654347014, 0.26555860675545184, 0.2645217696446247, 0.2634765833771763, 0.2624231402216263, 0.2613898442681877, 0.2603587644075885, 0.2593205490204446, 0.2582752878232493, 0.2572230702773638, 0.25616398576843324, 0.2550981237726144, 0.25402534654317316, 0.2529452806045394, 0.25185771643090066, 0.25076128412049126, 0.24965581154330324, 0.24854301815003468, 0.24742413783157483, 0.246293849205999, 0.24515226262059667, 0.24399488318281923, 0.24283089328198554, 0.2416614887742239, 0.24048676955876247, 0.23930602267849257, 0.2381196609396315, 0.2369280874534296, 0.2357297997963194, 0.2345267996014375, 0.233325600054934, 0.23214729577920293, 0.2309709545311709, 0.22980794207397134, 0.2286408079454657, 0.2274687257306785, 0.22629303775891993, 0.2251140155708054, 0.22393179588545697, 0.22274853835780184, 0.22156222975427817, 0.220372009405262, 0.2191787542565249, 0.21798258762096195, 0.21678360750397854, 0.21558208886650543, 0.2143778818562206, 0.21317012975193864, 0.21196015326236545, 0.2107480519379065, 0.20953356803899142, 0.20831482958012812, 0.20709371985028985, 0.20586995277227052, 0.20464234579955018, 0.2034105553376726, 0.20217453628408474, 0.20093303240288676, 0.199688202008376, 0.19844237266253156, 0.1971956409762119, 0.19594810317712114, 0.19469978579505937, 0.19345055140670836, 0.19220013875159128, 0.1909492718505944, 0.18969798229235493, 0.18844634048194814, 0.1871945585192028, 0.1859419588167442, 0.1846874129801167, 0.18343293797539953, 0.18217558703890313, 0.18091812706119542, 0.17966090022313264, 0.1783983056566377, 0.17713619249818363, 0.17587471930807735, 0.17461063322205578, 0.1733466215676885, 0.17208360618436191, 0.17082160001688326, 0.169585765962754, 0.1683670650129479, 0.1671477544715299, 0.16592831125458626, 0.1647103121437379, 0.16349335508757437, 0.16227737480618373, 0.16106266691384605, 0.15984961831432457, 0.15863750800878587, 0.15742689409054964, 0.15621735385418012, 0.15500981192977242, 0.1538043243608125, 0.15260094539547014, 0.1513997274764589, 0.15019994752131108, 0.14900160037862042, 0.14780556561040897, 0.14662934183399565, 0.14556687620354306, 0.14450466214854546, 0.14344413894997077, 0.14279162110031485, 0.14267495246638368, 0.14255743143731162, 0.14243832446919133, 0.1423110636095795, 0.14218210876095713, 0.142051132808363, 0.14191880048138347, 0.14178593362145622, 0.14165252033342735, 0.14151613533404214, 0.14137965823902018, 0.14210209109641428, 0.1431127198292231, 0.14412015492832284, 0.14512407337222952, 0.14612124399203946, 0.14711384944720396, 0.1481035030982703, 0.14908956532097084, 0.15007295044885746, 0.15105373083065043, 0.15203197661166631, 0.15300775579505027, 0.15398024861249265, 0.15494878919138225, 0.15591466552919636, 0.15687808375434112, 0.1578368457330856, 0.158793531704517, 0.15974819652103317, 0.1606980139902732, 0.16164505402131485, 0.16259023575333587, 0.1635332683224754, 0.164474076787174, 0.16541254505428815, 0.16634790761384752, 0.1672814704252322, 0.16821332748137838, 0.1691430803055644, 0.1700713417935393, 0.17099722516367605, 0.17192065232976234, 0.17284270270435279, 0.17376335109603422, 0.17468251392216236, 0.17560039818304524, 0.1765170369214773, 0.17743246236919155, 0.17834670598290714, 0.17925889350046703, 0.18016977865303316, 0.1810794779923141, 0.18198811592191066, 0.18289503373140317, 0.183798736941592, 0.18469966283639322, 0.18559964427870057, 0.1864987076551717, 0.18739556509074912, 0.18829000200272789, 0.18918291189970252, 0.19007440433518277, 0.19096260820321792, 0.19186051852373046, 0.19275683075732103, 0.1936513026467487, 0.19454512811487726, 0.1954390098098647, 0.19633170137787115, 0.19722354625908634, 0.1981145883262592, 0.19900456988511914, 0.1998938700214202, 0.2007825098457497, 0.2016696254379647, 0.2025543932522159, 0.20343857695246126, 0.20431827490240473, 0.2051968495810669, 0.20607407697985847, 0.2069486730831185, 0.20782254806981668, 0.20869572889435986, 0.20956809799180107, 0.2104398429983677, 0.21131099846810844, 0.21218138760669655, 0.21305091738150558, 0.21391920978783585, 0.21478516599386152, 0.21565084318528369, 0.2165162914789849, 0.2173815285612219, 0.2182465719520022, 0.21911129087886766, 0.21997510880861895, 0.22083807927682747, 0.22170092396893037, 0.22256365967641703, 0.2234263030326142, 0.2242882738976119, 0.22514967075385486, 0.22601029304186288, 0.2268707197283497, 0.227729470259677, 0.2285865174529598, 0.2294396402537047, 0.23029250825500538, 0.2311462710351777, 0.23201335528862171, 0.23288060408514563, 0.23374803277728337, 0.2346156565328601, 0.23548349033561275, 0.2363515489857826, 0.23721984710067479, 0.23808839911519822, 0.23895708105874341, 0.23982470287254937, 0.2406924713492426, 0.2415601957814636, 0.2424281083251551, 0.2432963692629917, 0.24416499177743814, 0.24503398887051064, 0.24590337336429366, 0.24677315790147206, 0.24764335494587023, 0.24851397678301912, 0.2493855894480284, 0.25025777067212057, 0.2511296877816255, 0.25200163700781486, 0.25287406486128433, 0.2537463296247271, 0.25461854186251737, 0.25549096159525764, 0.2563635371479469, 0.2572366547253222, 0.2581103246181237, 0.2589845569468094, 0.2598593616626537, 0.2607347485489066, 0.2616106173013547, 0.2624853576055149, 0.2633592562699449, 0.26423293399636927, 0.2651072473082701, 0.26598220512521015, 0.2668578162068842, 0.26773386155133155, 0.26861087136344913, 0.26948920581662317, 0.27036752863998414, 0.2712465383227166, 0.2721273417282873, 0.27301084089130684, 0.27389503319097824, 0.2747799259092555, 0.2756655261911491, 0.27655174638188484, 0.2774383112065764, 0.2783256065160093, 0.27921232683177943, 0.28009875062804035, 0.2809859349764984, 0.2818738862330761, 0.28276261063801517, 0.2836517448391473]
    # H_values_mackey_17_2 = [0.4065877847472891, 0.4059747496072562, 0.4053392738510184, 0.4046740485508077, 0.40400234040378225, 0.4033181037688748, 0.40262371733149216, 0.4019224689108622, 0.40121228745387394, 0.40049001102150444, 0.3997727077604963, 0.39904867539284083, 0.3983163214207031, 0.3975740983010459, 0.3968167196367569, 0.396049749369727, 0.3952725844053757, 0.3944818962837051, 0.3936769336297805, 0.3928456380225466, 0.3920033621680172, 0.39114928174824887, 0.3902850744378714, 0.3894114888843795, 0.38852921061005113, 0.3876373783458739, 0.38673647046564225, 0.385826728188262, 0.3849052718701172, 0.38397686961849453, 0.3830416242086676, 0.38209740524067376, 0.3811442022427058, 0.380182010517477, 0.3792108311170454, 0.378229869063427, 0.37723408115581697, 0.37622686135757893, 0.375210634200959, 0.3741828388138345, 0.37314455852071443, 0.3720956906787574, 0.3710361316376196, 0.3699638327594514, 0.36888211930448966, 0.3677912456216752, 0.36669108356543745, 0.36558236214513645, 0.36446534884618464, 0.36333939537516396, 0.3622049071687424, 0.36106055650096447, 0.3599074561822346, 0.358746538359204, 0.357577900398886, 0.35640058031192035, 0.35521517706284206, 0.3540224008894954, 0.3528223609281403, 0.35161516908925466, 0.3504001080328282, 0.3491751966025026, 0.3479360174000972, 0.34668836427185495, 0.3454298139437688, 0.3441683545194191, 0.3429064402730135, 0.3416369450695983, 0.34036141812633297, 0.3390800648790384, 0.3377930176403207, 0.3365004097945903, 0.33520228344881203, 0.3338948509670103, 0.33257796874950757, 0.33125615515111384, 0.329929547174712, 0.3285982821715204, 0.3272615853970224, 0.3259202203691126, 0.3245746123023494, 0.32322517309810844, 0.32187209022553664, 0.32051665791310124, 0.31915580391343495, 0.31778846585192644, 0.3164149305499124, 0.31503655102530925, 0.31365356925126187, 0.31226400113982516, 0.3108689805789431, 0.30947132053733056, 0.30807115272432, 0.30666860788974193, 0.30526381576889067, 0.30385670452406, 0.30244725183455134, 0.301033395770743, 0.2996150719197007, 0.29819521889215034, 0.2967739586116095, 0.2953510698142983, 0.29392692689245614, 0.29250160384601137, 0.2910725902497088, 0.28962761927585207, 0.28818176636674697, 0.2867353128113262, 0.2852885360356783, 0.28384154514066234, 0.282394447631975, 0.2809410326605041, 0.27948269983584856, 0.2780245548327351, 0.2765668022616272, 0.2751089663038178, 0.2736508985526632, 0.27219285361758244, 0.27073541279189917, 0.26927853736634166, 0.2678223861229925, 0.2663645150189746, 0.26490802426886795, 0.26353733110971206, 0.26237072428653924, 0.2612031686059985, 0.2600327814664434, 0.2588609076140513, 0.25768407676466765, 0.2565057339065096, 0.25532696124115806, 0.2541480073092074, 0.2529686890817435, 0.25178631690861003, 0.25060336765928853, 0.24941838683781956, 0.24823354583493235, 0.24704826966445595, 0.2458610954362683, 0.24467431434512057, 0.24348798436399094, 0.24230097868964948, 0.24111218287592362, 0.2399231967059654, 0.23873441219338004, 0.2375460245337805, 0.23635844824256655, 0.23517173378175082, 0.23398593062867332, 0.2327974920036105, 0.23160869323552535, 0.23042097185496455, 0.22923437372153102, 0.22804894380939886, 0.2268647262285053, 0.22568151207190712, 0.2244992789215322, 0.22331838828858072, 0.22213888105411078, 0.22096037177949812, 0.2197827127972113, 0.21860652981734852, 0.21743189547709288, 0.21625884697970582, 0.2150874208613532, 0.21391765300858512, 0.21274854061846185, 0.21157918762403816, 0.21041105671772758, 0.20924323095024852, 0.208077106207471, 0.20691286748889998, 0.20575054659104428, 0.20458947152137372, 0.2034262320398403, 0.2022650208774418, 0.20110558454273295, 0.19994717574246798, 0.19879075398768872, 0.19763624551948444, 0.1964839175561746, 0.1953337974677836, 0.1941859121111428, 0.19304028782794763, 0.19189695044150196, 0.1907559252521658, 0.189617237031517, 0.1884809100152594, 0.1873469678949096, 0.18621543380830052, 0.18508633032895494, 0.18395929078155537, 0.1828346360579576, 0.1817124721726038, 0.1805924909180628, 0.179475027256284, 0.17836011591384202, 0.17724777517006626, 0.17613802262098135, 0.17503087516200583, 0.17392634897043138, 0.17282445948780076, 0.17172522140231813, 0.17062851595175532, 0.16953395809918162, 0.1684417864082391, 0.16735209361054615, 0.1662647283098807, 0.16518009499633649, 0.16561424172933334, 0.16651331074995154, 0.16741243703003814, 0.16831165933615777, 0.16921101503889863, 0.17011044567381078, 0.1710100151008939, 0.1719098232315152, 0.1728097052900967, 0.17370984638636394, 0.17461032325004827, 0.17551116352694754, 0.1764123935227549, 0.1773140382183421, 0.17821612128695966, 0.1791182548626996, 0.18001640970475016, 0.18091080455793282, 0.1818056481173918, 0.1827003897104706, 0.18359514838144628, 0.184489977913001, 0.18538506333230317, 0.18628077444959096, 0.18717712352734953, 0.18807412182144173, 0.1889713062882841, 0.18986858382808416, 0.1907665436623641, 0.1916651934125621, 0.19256408151281876, 0.1934636619847865, 0.1943617771766576, 0.19526012990599542, 0.19615881981369362, 0.197058185510246, 0.19795797449498645, 0.19885830801192284, 0.19975917339545562, 0.20065846012184946, 0.20155799035332272, 0.2024576540699014, 0.20335785627834108, 0.20425823928192888, 0.20515935981671027, 0.20606083626128338, 0.2069620365401137, 0.20786351525543909, 0.2087649040311572, 0.20966530206877743, 0.21056445907430077, 0.21146406038545798, 0.21236852906093112, 0.213273123592383, 0.2141783885169928, 0.2150843233595602, 0.2159909276763357, 0.21689767242785402, 0.2178029722119135, 0.2187087494358343, 0.21962243366709563, 0.22054005110214644, 0.2214582199109682, 0.22237676967322964, 0.22329386213610436, 0.22421379768575284, 0.2251347217776082, 0.22605622673326894, 0.22697550174806808, 0.2278945048948616, 0.22881235717941428, 0.22973082722310809, 0.23064991763815026, 0.23156963118547885, 0.23248997077532174, 0.2334109394671179, 0.2343324069754603, 0.2352543037308251, 0.23617683412982127, 0.237100001842499, 0.23802381067988262, 0.23894826459089208, 0.2398733676588901, 0.24079912409789728, 0.24172553824850052, 0.2426526145734946, 0.24358035765327896, 0.2445087721810454, 0.24543786295777692, 0.24636763488708888, 0.24729809296993843]
    # H_values_mackey_17_3 = [0.35968014974086204, 0.35885340014553896, 0.35801151109439733, 0.3571557245363327, 0.3562864965272904, 0.35540393620037924, 0.3545303602262713, 0.35366564261391725, 0.3528017126095744, 0.3519306734335416, 0.3510726228191002, 0.35028697423778543, 0.3494833437068402, 0.3486617358777976, 0.3478218526092171, 0.3469559870829569, 0.34605891589640153, 0.3451426094800916, 0.3442086035510345, 0.3432585483008167, 0.34233970364490457, 0.3414078441742851, 0.3404471836825637, 0.3394699551644725, 0.3384763554140119, 0.33747759476387407, 0.3364640052652917, 0.3354359639242669, 0.3343936845981628, 0.3333367111054252, 0.33226519638035984, 0.33117973082394586, 0.33007906867041487, 0.3289928377702908, 0.32789246763768326, 0.3267779734624387, 0.32564960488515676, 0.3245089690398329, 0.32335479895351704, 0.32218731353226976, 0.32100643160931963, 0.31981223164848205, 0.31860384169195327, 0.3173837691509384, 0.31614783647454286, 0.31489779345793983, 0.3136310599215498, 0.31234825490220886, 0.31105423185059594, 0.30974958619994875, 0.30843672397351196, 0.30713521405846383, 0.3058311434634722, 0.30452022678284785, 0.3032003656582588, 0.30187688345629565, 0.30054583586255673, 0.2992090402694702, 0.2978666990819701, 0.296518998003721, 0.2951662783832973, 0.29380894682203773, 0.292446704944091, 0.2910786382177589, 0.289706800495488, 0.2883314632086724, 0.28695289277060565, 0.2855713500211099, 0.2841865940562682, 0.28279922925013146, 0.2814039449150974, 0.28000610704795936, 0.2786110894063024, 0.2772167272695237, 0.27582115837005844, 0.2744204255174862, 0.2730176232044781, 0.2716128524115185, 0.27020733335178093, 0.26880119342071107, 0.26739502417180155, 0.26598896746834144, 0.26458315649194647, 0.26317702529416426, 0.26177087729702336, 0.2603658906684434, 0.2590605682156297, 0.2577528045169669, 0.2564420519861969, 0.2551301978941063, 0.25381644402876485, 0.25250282962973647, 0.25118908275194607, 0.2498753399209742, 0.24856116289789468, 0.24724537417336176, 0.24593108588122553, 0.24461829012597874, 0.24330691910146585, 0.2419970566708124, 0.240688564515346, 0.2393816058415491, 0.2380754102501419, 0.2367698058310638, 0.23546380659686708, 0.2341577116594698, 0.23285323703730706, 0.23155027368724715, 0.23024965114502793, 0.22895748913847377, 0.22775736988871523, 0.22656473897153304, 0.2253723284379192, 0.22417915125907448, 0.22298635900966213, 0.22179450430733935, 0.22066821854138038, 0.21957428261296408, 0.2184795044723437, 0.21738306813468208, 0.21628635806788554, 0.2151903651347997, 0.21409512844915013, 0.2130006872752379, 0.21190708097948055, 0.21081434898148796, 0.209722530705194, 0.208631157457733, 0.20753844633823926, 0.20644677238950151, 0.20535605665643397, 0.2042663604446756, 0.20317782099295192, 0.2020904765451053, 0.20100421523050635, 0.19991552547497074, 0.1988257954851067, 0.19773742418007448, 0.19664997350670418, 0.19557180124650167, 0.19449995219973476, 0.19342939940852724, 0.19236017855434895, 0.19129232474613744, 0.19022587250401585, 0.18916085574489586, 0.1880973077698855, 0.18703512100487518, 0.18688500661091373, 0.1877897123666171, 0.188691018535178, 0.18958934721593984, 0.19048477949814877, 0.19137713786897087, 0.1922649696362028, 0.1931493359208539, 0.1940309155737566, 0.1949091758801653, 0.19578483484659417, 0.19665731927460003, 0.1975267725447435, 0.19839402352688904, 0.19925839465236947, 0.20011995329184354, 0.200979511002628, 0.20183727120446798, 0.20269344644366438, 0.2035478119599106, 0.20440042810426975, 0.20525124990494786, 0.20610034886252157, 0.20694255231865588, 0.20780351362043858, 0.208667972531899, 0.20953097143726, 0.21039219503645754, 0.21125160338492072, 0.21210971383036073, 0.2129663694958675, 0.2138208538273464, 0.2146742004787724, 0.21552645708458615, 0.21637767038319236, 0.217227986613984, 0.21808198180144256, 0.2189350607417357, 0.21978596037376982, 0.22063563942090236, 0.22148433312104726, 0.2223322906607816, 0.22317955187196797, 0.22402615585350158, 0.2248713353872813, 0.22571552333102712, 0.22655657205041976, 0.22739402683893228, 0.22823053264121806, 0.2290664190758827, 0.22990178334077274, 0.23074060039505678, 0.23158220074721186, 0.23242315562809915, 0.23326369687946616, 0.2341035088094814, 0.23494253195354917, 0.23578101268479443, 0.2366189991331962, 0.23745674147016227, 0.23829427006145631, 0.23913161477441522, 0.23996880498935952, 0.24080542695021862, 0.2416419341701127, 0.24247837384247148, 0.24331375650840803, 0.244147936244523, 0.24498213890556927, 0.2458163906854094, 0.24665046017838585, 0.24748181862975896, 0.2483132551033317, 0.24914355387744153, 0.24997252172357148, 0.25080059836265206, 0.25162864263296403, 0.2524566048636597, 0.25328486281677387, 0.25411343890623456, 0.2549423552203034, 0.2557716335280638, 0.2566012373960372, 0.25743072141368295, 0.2582606311702252, 0.25909098722861246, 0.25992180986150354, 0.2607527930260516, 0.2615837088695182, 0.26241515742325056, 0.2632471578236241, 0.2640796671822586, 0.26491229883884576, 0.2657448741836629, 0.26657436653001265, 0.2674035886348926, 0.2682329911671551, 0.26906273520643653, 0.26989320696107194, 0.27072442331434227, 0.27155609458247787, 0.2723885358131624, 0.273221773005585, 0.27405460534483367, 0.2748868467615394, 0.275719377078016, 0.2765527764622426, 0.2773870597841848, 0.27822224167979975, 0.27905833655143725, 0.27989535856807396, 0.2807322517812876, 0.28157005093939785, 0.2824074464046764, 0.28324283192317284, 0.28407918955612627, 0.28491657349478855, 0.2857537184731212, 0.2865906879125686, 0.28742730176398434, 0.2882646947977603, 0.28910302022957224, 0.289940621418669, 0.2907784855909796, 0.29161723026461395, 0.29245666919108854, 0.2932971605339655, 0.2941385714091796, 0.29498006112038483, 0.2958224334601302, 0.29666598330644045, 0.29750916177465275, 0.2983514900644023, 0.2991931570343365, 0.30003569222134674, 0.30087905324884895, 0.3017236255010777, 0.3025694352725556, 0.30341649018267464, 0.30426465414117904, 0.3051130184316714, 0.30596126599980605, 0.30680917886953746, 0.30765670976128, 0.30850493117348593, 0.30935445713727866, 0.3102052932264972, 0.3110574447459205, 0.31191088289866015, 0.3127651020595012, 0.313620649076048, 0.3144775281635343]
    # H_values_mackey_17_4 = [0.4171975730823765, 0.41653467122377325, 0.41585582217936484, 0.41515812311821343, 0.41444282696832097, 0.41370214050933013, 0.41294488183553557, 0.4121709769919823, 0.4113803818518729, 0.4105650633634447, 0.4097262488695063, 0.4088704849825941, 0.4079982380909459, 0.407109516878769, 0.40620262378466687, 0.4052767172866817, 0.404334529326795, 0.40337429078644566, 0.4023976671819063, 0.40140363404577106, 0.4003919180689601, 0.39936400627462565, 0.39831962857809816, 0.39725500714769996, 0.39616873263061647, 0.39506341857699223, 0.39394593009607, 0.3928118244722405, 0.39166106001617107, 0.3904927868818796, 0.38930857996059764, 0.38810851615548586, 0.3868926791963206, 0.38566115969014686, 0.3844133575644628, 0.3831495712812623, 0.3818704309848918, 0.38057601638917254, 0.37926617423286213, 0.37794135881934615, 0.3766017061779341, 0.37524735809217186, 0.37387846181553647, 0.3724954973576773, 0.3710983122280524, 0.3696865892329244, 0.3682590156838008, 0.3668167914483479, 0.3653590156466883, 0.36388783683288617, 0.36240273484341545, 0.3609037781276675, 0.3595624323285651, 0.3584110863190792, 0.35724157648145616, 0.3560533963610269, 0.3548471641479848, 0.35362389521223325, 0.35238354228762986, 0.35112590265424176, 0.34985200563367685, 0.34856156830641727, 0.34725506510697735, 0.3459330380359362, 0.3445916201298346, 0.34322807340082995, 0.34184808266154376, 0.34045345401848864, 0.3390429539807886, 0.3376170891810984, 0.33617711712101256, 0.3347236074737357, 0.33325523872789686, 0.33177304156636833, 0.3302778720103541, 0.32877007223069404, 0.32724901443840787, 0.32571474454193267, 0.3241670774303549, 0.32260768271706086, 0.32103661893946805, 0.3194528897338374, 0.31785763061549116, 0.31625124856954906, 0.31463411360041055, 0.3130064114958745, 0.3113681573591521, 0.3097192694799693, 0.30805928823125645, 0.30638874237406044, 0.304708542067733, 0.30301789049042266, 0.3013176527258352, 0.29960731092802007, 0.2983947201358448, 0.2974541922076279, 0.29650568925799897, 0.2955499607291644, 0.2945892594386033, 0.29362366378424015, 0.2926532616192463, 0.291677224894813, 0.2906961599794287, 0.2897104175991141, 0.28871621213783766, 0.28771734222572065, 0.28671395847998954, 0.28570611018323755, 0.28469384665283065, 0.2836772171865282, 0.2826562710105415, 0.2816310039787517, 0.28059903863183083, 0.2795562544981316, 0.2785105519192877, 0.2774586639439322, 0.276401674006524, 0.27534055108459987, 0.2742747645609712, 0.27320362238362256, 0.2721272416202783, 0.271045477807835, 0.2699600505479811, 0.2688710037127715, 0.2677783806699119, 0.26668176728022164, 0.26558062468196564, 0.26447513812298296, 0.2633638707999525, 0.26224793082944464, 0.2611284765259831, 0.2600055477212302, 0.25887938168355346, 0.25775001671970815, 0.2566176419280081, 0.2554821776509502, 0.25434361925132454, 0.25320200253971187, 0.252057362760051, 0.25090941463058825, 0.24975771263958949, 0.24860401834510035, 0.24744895651536167, 0.24628927220471866, 0.24512640449350528, 0.24396068431672288, 0.24279119178747624, 0.24161900773230585, 0.2404429350321793, 0.23925641584641844, 0.23806680783834222, 0.2368725686311926, 0.23567460835736387, 0.2344727636106875, 0.23326808829329512, 0.23206070721120386, 0.23085715222307573, 0.22965182661540826, 0.22844318760350155, 0.22723198611834258, 0.22601778844098946, 0.2248001244368745, 0.22358018122477477, 0.22235726065548803, 0.22112996170077065, 0.21990020204295682, 0.21866734269978402, 0.2174318457646003, 0.21619353729093452, 0.2149516816819916, 0.21370740954923706, 0.21246111622527752, 0.21121282371224098, 0.20996171800076957, 0.20870273203731918, 0.20744036345589237, 0.20617396452267142, 0.20490572128606147, 0.20363565496959796, 0.2023634848871737, 0.2010894971236594, 0.1998132518354029, 0.1985351659133142, 0.19725507909342435, 0.19597311257180366, 0.1946892737700818, 0.19340359299082055, 0.1921162890706003, 0.19082738148954445, 0.18953688945285432, 0.18824483186351046, 0.1869512272933153, 0.18565609395248342, 0.18435944965798057, 0.18306131180087515, 0.1817616973129582, 0.180459229677625, 0.1791551556929382, 0.17784772216605998, 0.17653700530262223, 0.1770522863245464, 0.17778837506111245, 0.17852018094749328, 0.1792477674012763, 0.1799711964175089, 0.18069052855880166, 0.18140582294795227, 0.1821167921897853, 0.18282374524759207, 0.1835240632378371, 0.18421843829671855, 0.18490905944502675, 0.185595977581588, 0.18650892855098175, 0.1875356685394777, 0.18855924717715267, 0.1895789017884935, 0.19059523758125604, 0.19160961333957938, 0.19262093439449296, 0.19362985165216717, 0.1946370206214348, 0.1956424555858038, 0.19664617002483045, 0.19764817665615908, 0.19864848747861197, 0.19964711381601816, 0.2006429410096372, 0.20163552200153598, 0.2026257965470586, 0.2036140622263041, 0.20460068869931658, 0.20558534678077858, 0.2065679014554522, 0.20754831688146844, 0.20852566629760114, 0.20949920049091272, 0.21047084637407593, 0.2114400244089778, 0.21240746768462168, 0.21337335664292856, 0.21433769759389154, 0.21530031455213444, 0.2162612569323131, 0.2172206530250388, 0.21817819021193197, 0.2191342155596629, 0.22008873505223786, 0.22104147751229108, 0.2219927107769454, 0.2229424579520882, 0.223890725181843, 0.2248373324703988, 0.22578241960372764, 0.22672531263376355, 0.22766648276445212, 0.22860594937492135, 0.22954378095451966, 0.23048017279624292, 0.231415131715461, 0.2323486646085896, 0.23328077845143383, 0.2342113082686614, 0.2351402964081519, 0.23606782346175317, 0.23699244524769048, 0.2379156802713806, 0.23883753598195684, 0.23975801988338302, 0.24067713952977615, 0.24159490252057128, 0.24251131649555693, 0.2434257937343625, 0.24433416462279725, 0.24524120692447132, 0.2461469282069694, 0.24705131797009963, 0.24795357628582768, 0.24885449463117038, 0.24975412029759278, 0.2506524609265636, 0.25154952414838355, 0.25244526320716554, 0.2533387759567911, 0.2542302038163125, 0.2551192386709808, 0.25600682090409826, 0.2568931610269644, 0.2577782665290223, 0.25866214485387795, 0.2595448033954853, 0.26042624949446413, 0.2613064904345523, 0.2621855334391888, 0.26306338566823306, 0.2639400542148171, 0.26481554610232994, 0.2656898682815385, 0.2665630276278375, 0.2674350309386357]
    # H_values_mackey_17_5 = [0.36125596853507025, 0.3604853510327915, 0.35969540927857324, 0.358885097876233, 0.358050377262484, 0.35719409226225934, 0.3563197521008485, 0.35542134174565737, 0.3545008054837903, 0.3535597085073908, 0.3526011479590885, 0.35163998806488467, 0.35069663327077355, 0.34973992946936283, 0.34876844733275014, 0.3477815392485593, 0.34678276923243595, 0.345766543376536, 0.344739716719211, 0.3437016052328426, 0.34265228379232, 0.3415925373651725, 0.3405236321949026, 0.3394446339516294, 0.33835699910333816, 0.33725992822597534, 0.3361534801395654, 0.33503913568647703, 0.33401867110023953, 0.33304292791034157, 0.33206050400215076, 0.33106782535531143, 0.33006794724963084, 0.32906206445859143, 0.3280491663057199, 0.327022798241645, 0.3259833695492051, 0.3249322181846796, 0.3238721498313822, 0.3228070631553258, 0.3217366749765003, 0.32069464243736867, 0.3196917741867337, 0.31867879648134784, 0.31765726692563145, 0.3166303704710083, 0.3155981612134835, 0.3145541088987463, 0.31350378072184154, 0.31244832648433696, 0.3113878049737826, 0.3103198562051924, 0.3092445820237148, 0.3081628140189118, 0.30707591086945735, 0.305984267340739, 0.3048879507553432, 0.3037870295958657, 0.302678905527072, 0.30156477352297184, 0.3004462697622459, 0.29932346694364415, 0.2981947217198142, 0.297050920044975, 0.29590263998442795, 0.294750458358384, 0.29359417059982434, 0.29242770926355593, 0.29125509245101566, 0.29007875056225174, 0.2888949907557287, 0.2877041364012031, 0.28650730591549906, 0.28530712611148673, 0.28410375548075756, 0.2828926865973259, 0.2816747891662155, 0.2804536609586085, 0.27922778395027986, 0.27799917484672454, 0.27676768996560586, 0.2755303988376947, 0.2742917318138909, 0.27304919923314974, 0.2718035483498952, 0.27055446206792294, 0.2693001304086758, 0.2680415639249505, 0.2667775541596287, 0.26551113466475584, 0.26424186735694527, 0.26295786792435116, 0.26167109489360574, 0.2603822664425312, 0.25909101062214734, 0.25779826152626695, 0.2565037851789472, 0.25520798108861537, 0.25391085529081414, 0.25261108297553214, 0.2513104084160745, 0.25000893155864623, 0.2487067199318805, 0.2474038401710301, 0.24609971938493008, 0.24479435585163173, 0.24348736022192558, 0.24217736669916085, 0.2408670582330282, 0.23955644756479344, 0.23824458200197038, 0.23693532189537678, 0.23565320350029834, 0.23436773771541758, 0.23308210273154134, 0.23179635979310856, 0.23051056692001615, 0.229223734893221, 0.22793637550971627, 0.22664915533728447, 0.22535998089661338, 0.22406988251199722, 0.22277826987424473, 0.22148587897698968, 0.2201934878000104, 0.21890157874384739, 0.2176101988225537, 0.21635192830993583, 0.21512239325887222, 0.2138960860377358, 0.2126696165213813, 0.21144104082749976, 0.2102127808813735, 0.208985025354325, 0.2077578174760153, 0.20653119941523046, 0.20530492921514978, 0.20407934260889113, 0.2028547706817783, 0.20163093853541839, 0.200406763262435, 0.19918323976426455, 0.1979605700623049, 0.1967387116024604, 0.1955168552441633, 0.1942918093534143, 0.19429968665068062, 0.19526535869182562, 0.1962259008182861, 0.197181772974033, 0.19813380562972777, 0.19908188778257377, 0.20002591412852183, 0.2009667331779015, 0.20190261538144902, 0.2028348128633085, 0.20376405511674617, 0.20469041797234688, 0.20561397572413662, 0.206534801162784, 0.20745296560806997, 0.2083685056598746, 0.20928062326024574, 0.21018983642448705, 0.21109550323524623, 0.21199726910797043, 0.2128940786431241, 0.2137861322361037, 0.21467607940272815, 0.21556397962476434, 0.21644972974330143, 0.21733062790281166, 0.2182090502838148, 0.21908562538206106, 0.21996046454326537, 0.22083362065770967, 0.221705145560617, 0.22257442380015927, 0.22344172151662894, 0.22430754110906762, 0.2251719304111454, 0.22603493630811122, 0.22689653968308074, 0.2277566331593232, 0.2286154803291855, 0.22947108288712945, 0.23032427221588742, 0.23117570773232607, 0.23202569678614376, 0.23287467121618946, 0.2337226703664012, 0.23456973280592697, 0.23541578743086844, 0.23626089456036864, 0.23710512111842547, 0.2379481848173707, 0.2387904987135221, 0.23963205796331816, 0.24047254121298042, 0.24131238138156577, 0.2421518940514631, 0.2429894827198038, 0.24382579397566348, 0.2446616135700754, 0.2454969714369903, 0.24633188578694298, 0.2471653037288052, 0.2479970392688688, 0.24882841289714097, 0.24965854167844448, 0.2504881256331646, 0.2513174533960832, 0.25214618270825334, 0.25297438124196076, 0.2538009429516496, 0.25462719156697694, 0.25545251108513445, 0.25627661091716525, 0.25709926141843853, 0.2579212038316005, 0.258741209404537, 0.2595594143088125, 0.2603830740374639, 0.2612083859297954, 0.2620336981809922, 0.2628587365454553, 0.2636835907912246, 0.2645085100976988, 0.265333513720626, 0.2661586205783748, 0.2669838492609258, 0.2678092180387669, 0.2686344425425293, 0.2694594942848735, 0.2702845644109787, 0.2711084338157839, 0.27193247430771644, 0.2727567041674125, 0.2735805969732141, 0.2744047705310326, 0.27522718917632305, 0.2760448077667737, 0.2768627605673164, 0.2776809561357969, 0.2784944492154315, 0.27930831843195447, 0.2801225791031426, 0.2809372463540957, 0.2817523351244239, 0.28256786017532226, 0.28338383609653384, 0.28420073423948006, 0.2850195225059408, 0.285840169018871, 0.2866606420185152, 0.2874816236607089, 0.2883031277482897, 0.2891251679585427, 0.2899469592785576, 0.2907672909348163, 0.2915882149149256, 0.29240974441804884, 0.29323181172725477, 0.2940544513980426, 0.2948775089283209, 0.29570120042110964, 0.2965255595979396, 0.2973505991478717, 0.298176074068524, 0.2989932127659371, 0.2998089164621048, 0.30062541183800556, 0.3014425200165068, 0.30226034058850454, 0.30307899148520745, 0.30389848512634876, 0.30471883388129184, 0.3055400500719061, 0.30636214597525185, 0.3071851338260659, 0.30800902581905365, 0.3088331885208455, 0.30965803874481024, 0.3104834909558769, 0.3113077894719448, 0.3121330695649736, 0.3129588539950463, 0.31378527713511106, 0.31461260689110715, 0.31544097008903677, 0.31627037855076556, 0.31710084406813266, 0.31793220731878663, 0.3187645716989894, 0.3195972677903377, 0.32043085095136953, 0.3212655468385417, 0.3221013670959155, 0.3229383233309057, 0.32377642711245497]

    arr1, arr2, arr3, arr4, arr5 = H_lol[0], H_lol[1], H_lol[2], H_lol[3], H_lol[4]
    optimal_points = {
    'Mackey:tau = 17, 1': (optimal_q_list[0], optimal_H_list[0]),
    'Mackey:tau = 17, 2': (optimal_q_list[1], optimal_H_list[1]),
    'Mackey:tau = 17, 3': (optimal_q_list[2], optimal_H_list[2]),
    'Mackey:tau = 17, 4': (optimal_q_list[3], optimal_H_list[3]),
    'Mackey:tau = 17, 5': (optimal_q_list[4], optimal_H_list[4])

    }

    true_hurst_points = {
        'Mackey: tau = 17, 1': [true_list[0], '#1f77b4'],
        'Mackey: tau = 17, 2': [true_list[1], '#ff7f0e'],
        'Mackey: tau = 17, 3': [true_list[2], '#2ca02c'],
        'Mackey: tau = 17, 4': [true_list[3], '#d62728'],
        'Mackey: tau = 17, 5': [true_list[4], '#9467bd']
    }

    # Create a common q_values array
    q_values_common = np.arange(0.1, 3.1, 0.01)
    print(len(q_values_common))



    arr1_adapt = adapt_y_values(np.arange(0.1, 3.1, 0.01), arr1, q_values_common)
    arr2_adapt = adapt_y_values(np.arange(0.1, 3.1, 0.01), arr2, q_values_common)
    arr3_adapt = adapt_y_values(np.arange(0.1, 3.1, 0.01), arr3, q_values_common)
    arr4_adapt = adapt_y_values(np.arange(0.1, 3.1, 0.01), arr4, q_values_common)
    arr5_adapt = adapt_y_values(np.arange(0.1, 3.1, 0.01), arr5, q_values_common)


    plt.figure(figsize=(15, 10))


    plots = [
        (q_values_common, arr1_adapt, 'Mackey:tau = 17, 1', '-', 'o'),
        (q_values_common, arr2_adapt, 'Mackey:tau = 17, 2', '-', 's'),
        (q_values_common, arr3_adapt, 'Mackey:tau = 17, 3', '-', '^'),
        (q_values_common, arr4_adapt, 'Mackey:tau = 17, 4', ':', 'x'),
        (q_values_common, arr5_adapt, 'Mackey:tau = 17, 5', ':', '+'),
    ]

    # Store colors to use for optimal values later
    colors = []

    # Plotting
    for q_vals, H_vals, label, linestyle, marker in plots:
        line, = plt.plot(q_vals, H_vals, label=label, linestyle=linestyle, marker=marker, markevery=20)
        colors.append(line.get_color())

    # Additional Plot Settings
    plt.xlabel('q values', fontsize=14)
    plt.ylabel('Hurst Exponent (H)', fontsize=14)
    plt.title('Hurst Exponent (H) vs. q values', fontsize=16)

    # Marking optimal points with corresponding colors
    for idx, (label, (q, h)) in enumerate(optimal_points.items()):
        plt.scatter(q, h, color=colors[idx], s=150, zorder=5)  # zorder to make sure it's on top
    ax = plt.gca()
    max_x_value = 3.11
    plt.axvline(x=max_x_value, color='grey', linestyle='--')
    # Plot the true Hurst exponents on the vertical line
    for label, h in true_hurst_points.items():
        ax.scatter(max_x_value, h[0], color=h[1], zorder=5, marker = 's')
        ax.text(max_x_value, h[0], f'  H={h[0]}', verticalalignment='center')
        ax.axhline(y=h[0], xmin=0, xmax=max_x_value / (max_x_value + 0.1 * (max_x_value - min(q_values_common))), color=h[1], linestyle=':', linewidth=1, alpha=1)

    # Draw the vertical line at the end of the x-axis
    plt.axvline(x=max_x_value, color='grey', linestyle='--')

    # Adjust the x-axis limits to make space for the text
    plt.xlim(min(q_values_common), max_x_value + 0.1 * (max_x_value - min(q_values_common)))

    # Adjusting grid aesthetics
    plt.grid(True, which='both', linestyle='--', linewidth=0.5, alpha=0.7)
    plt.minorticks_on()
    plt.grid(which='major', linestyle='-', linewidth='0.5', color='black', alpha=0.6)
    plt.grid(which='minor', linestyle=':', linewidth='0.5', color='gray', alpha=0.5)

    # Legend specification
    # Add a black marker for the optimal value indication in the legend
    hurst_legend = plt.Line2D([0], [0], marker='o', color='w', label='Fractal UKF Optimal H', markersize=10, markerfacecolor='cyan')
    optimal_legend = plt.Line2D([0], [0], marker='s', color='w', label='True H', markersize=10, markerfacecolor='cyan')
    handles, labels = plt.gca().get_legend_handles_labels()
    handles.append(hurst_legend)
    handles.append(optimal_legend)
    plt.legend(handles=handles, fontsize=10, loc="best")

    # Show the plot
    plt.tight_layout()
    plt.show()

def plot_logmap(H_lol, optimal_q_list, optimal_H_list, true_list):
    # H_values_mackey_17_1 = [0.2887631449351124, 0.2877758713642961, 0.28683775304450776, 0.28601421448327513, 0.2851852669356111, 0.28436633520520765, 0.28353683655939943, 0.2826914063006998, 0.28183184745564877, 0.2809533696882219, 0.28006450988277237, 0.2791667026562684, 0.2782546604396615, 0.27733283470396963, 0.2764004698243641, 0.2754592436932236, 0.27450934607676836, 0.2735502185724154, 0.2725798635224196, 0.27160094192467654, 0.27061321167249325, 0.26961802644342525, 0.2686154944228409, 0.26760521672780474, 0.266586654347014, 0.26555860675545184, 0.2645217696446247, 0.2634765833771763, 0.2624231402216263, 0.2613898442681877, 0.2603587644075885, 0.2593205490204446, 0.2582752878232493, 0.2572230702773638, 0.25616398576843324, 0.2550981237726144, 0.25402534654317316, 0.2529452806045394, 0.25185771643090066, 0.25076128412049126, 0.24965581154330324, 0.24854301815003468, 0.24742413783157483, 0.246293849205999, 0.24515226262059667, 0.24399488318281923, 0.24283089328198554, 0.2416614887742239, 0.24048676955876247, 0.23930602267849257, 0.2381196609396315, 0.2369280874534296, 0.2357297997963194, 0.2345267996014375, 0.233325600054934, 0.23214729577920293, 0.2309709545311709, 0.22980794207397134, 0.2286408079454657, 0.2274687257306785, 0.22629303775891993, 0.2251140155708054, 0.22393179588545697, 0.22274853835780184, 0.22156222975427817, 0.220372009405262, 0.2191787542565249, 0.21798258762096195, 0.21678360750397854, 0.21558208886650543, 0.2143778818562206, 0.21317012975193864, 0.21196015326236545, 0.2107480519379065, 0.20953356803899142, 0.20831482958012812, 0.20709371985028985, 0.20586995277227052, 0.20464234579955018, 0.2034105553376726, 0.20217453628408474, 0.20093303240288676, 0.199688202008376, 0.19844237266253156, 0.1971956409762119, 0.19594810317712114, 0.19469978579505937, 0.19345055140670836, 0.19220013875159128, 0.1909492718505944, 0.18969798229235493, 0.18844634048194814, 0.1871945585192028, 0.1859419588167442, 0.1846874129801167, 0.18343293797539953, 0.18217558703890313, 0.18091812706119542, 0.17966090022313264, 0.1783983056566377, 0.17713619249818363, 0.17587471930807735, 0.17461063322205578, 0.1733466215676885, 0.17208360618436191, 0.17082160001688326, 0.169585765962754, 0.1683670650129479, 0.1671477544715299, 0.16592831125458626, 0.1647103121437379, 0.16349335508757437, 0.16227737480618373, 0.16106266691384605, 0.15984961831432457, 0.15863750800878587, 0.15742689409054964, 0.15621735385418012, 0.15500981192977242, 0.1538043243608125, 0.15260094539547014, 0.1513997274764589, 0.15019994752131108, 0.14900160037862042, 0.14780556561040897, 0.14662934183399565, 0.14556687620354306, 0.14450466214854546, 0.14344413894997077, 0.14279162110031485, 0.14267495246638368, 0.14255743143731162, 0.14243832446919133, 0.1423110636095795, 0.14218210876095713, 0.142051132808363, 0.14191880048138347, 0.14178593362145622, 0.14165252033342735, 0.14151613533404214, 0.14137965823902018, 0.14210209109641428, 0.1431127198292231, 0.14412015492832284, 0.14512407337222952, 0.14612124399203946, 0.14711384944720396, 0.1481035030982703, 0.14908956532097084, 0.15007295044885746, 0.15105373083065043, 0.15203197661166631, 0.15300775579505027, 0.15398024861249265, 0.15494878919138225, 0.15591466552919636, 0.15687808375434112, 0.1578368457330856, 0.158793531704517, 0.15974819652103317, 0.1606980139902732, 0.16164505402131485, 0.16259023575333587, 0.1635332683224754, 0.164474076787174, 0.16541254505428815, 0.16634790761384752, 0.1672814704252322, 0.16821332748137838, 0.1691430803055644, 0.1700713417935393, 0.17099722516367605, 0.17192065232976234, 0.17284270270435279, 0.17376335109603422, 0.17468251392216236, 0.17560039818304524, 0.1765170369214773, 0.17743246236919155, 0.17834670598290714, 0.17925889350046703, 0.18016977865303316, 0.1810794779923141, 0.18198811592191066, 0.18289503373140317, 0.183798736941592, 0.18469966283639322, 0.18559964427870057, 0.1864987076551717, 0.18739556509074912, 0.18829000200272789, 0.18918291189970252, 0.19007440433518277, 0.19096260820321792, 0.19186051852373046, 0.19275683075732103, 0.1936513026467487, 0.19454512811487726, 0.1954390098098647, 0.19633170137787115, 0.19722354625908634, 0.1981145883262592, 0.19900456988511914, 0.1998938700214202, 0.2007825098457497, 0.2016696254379647, 0.2025543932522159, 0.20343857695246126, 0.20431827490240473, 0.2051968495810669, 0.20607407697985847, 0.2069486730831185, 0.20782254806981668, 0.20869572889435986, 0.20956809799180107, 0.2104398429983677, 0.21131099846810844, 0.21218138760669655, 0.21305091738150558, 0.21391920978783585, 0.21478516599386152, 0.21565084318528369, 0.2165162914789849, 0.2173815285612219, 0.2182465719520022, 0.21911129087886766, 0.21997510880861895, 0.22083807927682747, 0.22170092396893037, 0.22256365967641703, 0.2234263030326142, 0.2242882738976119, 0.22514967075385486, 0.22601029304186288, 0.2268707197283497, 0.227729470259677, 0.2285865174529598, 0.2294396402537047, 0.23029250825500538, 0.2311462710351777, 0.23201335528862171, 0.23288060408514563, 0.23374803277728337, 0.2346156565328601, 0.23548349033561275, 0.2363515489857826, 0.23721984710067479, 0.23808839911519822, 0.23895708105874341, 0.23982470287254937, 0.2406924713492426, 0.2415601957814636, 0.2424281083251551, 0.2432963692629917, 0.24416499177743814, 0.24503398887051064, 0.24590337336429366, 0.24677315790147206, 0.24764335494587023, 0.24851397678301912, 0.2493855894480284, 0.25025777067212057, 0.2511296877816255, 0.25200163700781486, 0.25287406486128433, 0.2537463296247271, 0.25461854186251737, 0.25549096159525764, 0.2563635371479469, 0.2572366547253222, 0.2581103246181237, 0.2589845569468094, 0.2598593616626537, 0.2607347485489066, 0.2616106173013547, 0.2624853576055149, 0.2633592562699449, 0.26423293399636927, 0.2651072473082701, 0.26598220512521015, 0.2668578162068842, 0.26773386155133155, 0.26861087136344913, 0.26948920581662317, 0.27036752863998414, 0.2712465383227166, 0.2721273417282873, 0.27301084089130684, 0.27389503319097824, 0.2747799259092555, 0.2756655261911491, 0.27655174638188484, 0.2774383112065764, 0.2783256065160093, 0.27921232683177943, 0.28009875062804035, 0.2809859349764984, 0.2818738862330761, 0.28276261063801517, 0.2836517448391473]
    # H_values_mackey_17_2 = [0.4065877847472891, 0.4059747496072562, 0.4053392738510184, 0.4046740485508077, 0.40400234040378225, 0.4033181037688748, 0.40262371733149216, 0.4019224689108622, 0.40121228745387394, 0.40049001102150444, 0.3997727077604963, 0.39904867539284083, 0.3983163214207031, 0.3975740983010459, 0.3968167196367569, 0.396049749369727, 0.3952725844053757, 0.3944818962837051, 0.3936769336297805, 0.3928456380225466, 0.3920033621680172, 0.39114928174824887, 0.3902850744378714, 0.3894114888843795, 0.38852921061005113, 0.3876373783458739, 0.38673647046564225, 0.385826728188262, 0.3849052718701172, 0.38397686961849453, 0.3830416242086676, 0.38209740524067376, 0.3811442022427058, 0.380182010517477, 0.3792108311170454, 0.378229869063427, 0.37723408115581697, 0.37622686135757893, 0.375210634200959, 0.3741828388138345, 0.37314455852071443, 0.3720956906787574, 0.3710361316376196, 0.3699638327594514, 0.36888211930448966, 0.3677912456216752, 0.36669108356543745, 0.36558236214513645, 0.36446534884618464, 0.36333939537516396, 0.3622049071687424, 0.36106055650096447, 0.3599074561822346, 0.358746538359204, 0.357577900398886, 0.35640058031192035, 0.35521517706284206, 0.3540224008894954, 0.3528223609281403, 0.35161516908925466, 0.3504001080328282, 0.3491751966025026, 0.3479360174000972, 0.34668836427185495, 0.3454298139437688, 0.3441683545194191, 0.3429064402730135, 0.3416369450695983, 0.34036141812633297, 0.3390800648790384, 0.3377930176403207, 0.3365004097945903, 0.33520228344881203, 0.3338948509670103, 0.33257796874950757, 0.33125615515111384, 0.329929547174712, 0.3285982821715204, 0.3272615853970224, 0.3259202203691126, 0.3245746123023494, 0.32322517309810844, 0.32187209022553664, 0.32051665791310124, 0.31915580391343495, 0.31778846585192644, 0.3164149305499124, 0.31503655102530925, 0.31365356925126187, 0.31226400113982516, 0.3108689805789431, 0.30947132053733056, 0.30807115272432, 0.30666860788974193, 0.30526381576889067, 0.30385670452406, 0.30244725183455134, 0.301033395770743, 0.2996150719197007, 0.29819521889215034, 0.2967739586116095, 0.2953510698142983, 0.29392692689245614, 0.29250160384601137, 0.2910725902497088, 0.28962761927585207, 0.28818176636674697, 0.2867353128113262, 0.2852885360356783, 0.28384154514066234, 0.282394447631975, 0.2809410326605041, 0.27948269983584856, 0.2780245548327351, 0.2765668022616272, 0.2751089663038178, 0.2736508985526632, 0.27219285361758244, 0.27073541279189917, 0.26927853736634166, 0.2678223861229925, 0.2663645150189746, 0.26490802426886795, 0.26353733110971206, 0.26237072428653924, 0.2612031686059985, 0.2600327814664434, 0.2588609076140513, 0.25768407676466765, 0.2565057339065096, 0.25532696124115806, 0.2541480073092074, 0.2529686890817435, 0.25178631690861003, 0.25060336765928853, 0.24941838683781956, 0.24823354583493235, 0.24704826966445595, 0.2458610954362683, 0.24467431434512057, 0.24348798436399094, 0.24230097868964948, 0.24111218287592362, 0.2399231967059654, 0.23873441219338004, 0.2375460245337805, 0.23635844824256655, 0.23517173378175082, 0.23398593062867332, 0.2327974920036105, 0.23160869323552535, 0.23042097185496455, 0.22923437372153102, 0.22804894380939886, 0.2268647262285053, 0.22568151207190712, 0.2244992789215322, 0.22331838828858072, 0.22213888105411078, 0.22096037177949812, 0.2197827127972113, 0.21860652981734852, 0.21743189547709288, 0.21625884697970582, 0.2150874208613532, 0.21391765300858512, 0.21274854061846185, 0.21157918762403816, 0.21041105671772758, 0.20924323095024852, 0.208077106207471, 0.20691286748889998, 0.20575054659104428, 0.20458947152137372, 0.2034262320398403, 0.2022650208774418, 0.20110558454273295, 0.19994717574246798, 0.19879075398768872, 0.19763624551948444, 0.1964839175561746, 0.1953337974677836, 0.1941859121111428, 0.19304028782794763, 0.19189695044150196, 0.1907559252521658, 0.189617237031517, 0.1884809100152594, 0.1873469678949096, 0.18621543380830052, 0.18508633032895494, 0.18395929078155537, 0.1828346360579576, 0.1817124721726038, 0.1805924909180628, 0.179475027256284, 0.17836011591384202, 0.17724777517006626, 0.17613802262098135, 0.17503087516200583, 0.17392634897043138, 0.17282445948780076, 0.17172522140231813, 0.17062851595175532, 0.16953395809918162, 0.1684417864082391, 0.16735209361054615, 0.1662647283098807, 0.16518009499633649, 0.16561424172933334, 0.16651331074995154, 0.16741243703003814, 0.16831165933615777, 0.16921101503889863, 0.17011044567381078, 0.1710100151008939, 0.1719098232315152, 0.1728097052900967, 0.17370984638636394, 0.17461032325004827, 0.17551116352694754, 0.1764123935227549, 0.1773140382183421, 0.17821612128695966, 0.1791182548626996, 0.18001640970475016, 0.18091080455793282, 0.1818056481173918, 0.1827003897104706, 0.18359514838144628, 0.184489977913001, 0.18538506333230317, 0.18628077444959096, 0.18717712352734953, 0.18807412182144173, 0.1889713062882841, 0.18986858382808416, 0.1907665436623641, 0.1916651934125621, 0.19256408151281876, 0.1934636619847865, 0.1943617771766576, 0.19526012990599542, 0.19615881981369362, 0.197058185510246, 0.19795797449498645, 0.19885830801192284, 0.19975917339545562, 0.20065846012184946, 0.20155799035332272, 0.2024576540699014, 0.20335785627834108, 0.20425823928192888, 0.20515935981671027, 0.20606083626128338, 0.2069620365401137, 0.20786351525543909, 0.2087649040311572, 0.20966530206877743, 0.21056445907430077, 0.21146406038545798, 0.21236852906093112, 0.213273123592383, 0.2141783885169928, 0.2150843233595602, 0.2159909276763357, 0.21689767242785402, 0.2178029722119135, 0.2187087494358343, 0.21962243366709563, 0.22054005110214644, 0.2214582199109682, 0.22237676967322964, 0.22329386213610436, 0.22421379768575284, 0.2251347217776082, 0.22605622673326894, 0.22697550174806808, 0.2278945048948616, 0.22881235717941428, 0.22973082722310809, 0.23064991763815026, 0.23156963118547885, 0.23248997077532174, 0.2334109394671179, 0.2343324069754603, 0.2352543037308251, 0.23617683412982127, 0.237100001842499, 0.23802381067988262, 0.23894826459089208, 0.2398733676588901, 0.24079912409789728, 0.24172553824850052, 0.2426526145734946, 0.24358035765327896, 0.2445087721810454, 0.24543786295777692, 0.24636763488708888, 0.24729809296993843]
    # H_values_mackey_17_3 = [0.35968014974086204, 0.35885340014553896, 0.35801151109439733, 0.3571557245363327, 0.3562864965272904, 0.35540393620037924, 0.3545303602262713, 0.35366564261391725, 0.3528017126095744, 0.3519306734335416, 0.3510726228191002, 0.35028697423778543, 0.3494833437068402, 0.3486617358777976, 0.3478218526092171, 0.3469559870829569, 0.34605891589640153, 0.3451426094800916, 0.3442086035510345, 0.3432585483008167, 0.34233970364490457, 0.3414078441742851, 0.3404471836825637, 0.3394699551644725, 0.3384763554140119, 0.33747759476387407, 0.3364640052652917, 0.3354359639242669, 0.3343936845981628, 0.3333367111054252, 0.33226519638035984, 0.33117973082394586, 0.33007906867041487, 0.3289928377702908, 0.32789246763768326, 0.3267779734624387, 0.32564960488515676, 0.3245089690398329, 0.32335479895351704, 0.32218731353226976, 0.32100643160931963, 0.31981223164848205, 0.31860384169195327, 0.3173837691509384, 0.31614783647454286, 0.31489779345793983, 0.3136310599215498, 0.31234825490220886, 0.31105423185059594, 0.30974958619994875, 0.30843672397351196, 0.30713521405846383, 0.3058311434634722, 0.30452022678284785, 0.3032003656582588, 0.30187688345629565, 0.30054583586255673, 0.2992090402694702, 0.2978666990819701, 0.296518998003721, 0.2951662783832973, 0.29380894682203773, 0.292446704944091, 0.2910786382177589, 0.289706800495488, 0.2883314632086724, 0.28695289277060565, 0.2855713500211099, 0.2841865940562682, 0.28279922925013146, 0.2814039449150974, 0.28000610704795936, 0.2786110894063024, 0.2772167272695237, 0.27582115837005844, 0.2744204255174862, 0.2730176232044781, 0.2716128524115185, 0.27020733335178093, 0.26880119342071107, 0.26739502417180155, 0.26598896746834144, 0.26458315649194647, 0.26317702529416426, 0.26177087729702336, 0.2603658906684434, 0.2590605682156297, 0.2577528045169669, 0.2564420519861969, 0.2551301978941063, 0.25381644402876485, 0.25250282962973647, 0.25118908275194607, 0.2498753399209742, 0.24856116289789468, 0.24724537417336176, 0.24593108588122553, 0.24461829012597874, 0.24330691910146585, 0.2419970566708124, 0.240688564515346, 0.2393816058415491, 0.2380754102501419, 0.2367698058310638, 0.23546380659686708, 0.2341577116594698, 0.23285323703730706, 0.23155027368724715, 0.23024965114502793, 0.22895748913847377, 0.22775736988871523, 0.22656473897153304, 0.2253723284379192, 0.22417915125907448, 0.22298635900966213, 0.22179450430733935, 0.22066821854138038, 0.21957428261296408, 0.2184795044723437, 0.21738306813468208, 0.21628635806788554, 0.2151903651347997, 0.21409512844915013, 0.2130006872752379, 0.21190708097948055, 0.21081434898148796, 0.209722530705194, 0.208631157457733, 0.20753844633823926, 0.20644677238950151, 0.20535605665643397, 0.2042663604446756, 0.20317782099295192, 0.2020904765451053, 0.20100421523050635, 0.19991552547497074, 0.1988257954851067, 0.19773742418007448, 0.19664997350670418, 0.19557180124650167, 0.19449995219973476, 0.19342939940852724, 0.19236017855434895, 0.19129232474613744, 0.19022587250401585, 0.18916085574489586, 0.1880973077698855, 0.18703512100487518, 0.18688500661091373, 0.1877897123666171, 0.188691018535178, 0.18958934721593984, 0.19048477949814877, 0.19137713786897087, 0.1922649696362028, 0.1931493359208539, 0.1940309155737566, 0.1949091758801653, 0.19578483484659417, 0.19665731927460003, 0.1975267725447435, 0.19839402352688904, 0.19925839465236947, 0.20011995329184354, 0.200979511002628, 0.20183727120446798, 0.20269344644366438, 0.2035478119599106, 0.20440042810426975, 0.20525124990494786, 0.20610034886252157, 0.20694255231865588, 0.20780351362043858, 0.208667972531899, 0.20953097143726, 0.21039219503645754, 0.21125160338492072, 0.21210971383036073, 0.2129663694958675, 0.2138208538273464, 0.2146742004787724, 0.21552645708458615, 0.21637767038319236, 0.217227986613984, 0.21808198180144256, 0.2189350607417357, 0.21978596037376982, 0.22063563942090236, 0.22148433312104726, 0.2223322906607816, 0.22317955187196797, 0.22402615585350158, 0.2248713353872813, 0.22571552333102712, 0.22655657205041976, 0.22739402683893228, 0.22823053264121806, 0.2290664190758827, 0.22990178334077274, 0.23074060039505678, 0.23158220074721186, 0.23242315562809915, 0.23326369687946616, 0.2341035088094814, 0.23494253195354917, 0.23578101268479443, 0.2366189991331962, 0.23745674147016227, 0.23829427006145631, 0.23913161477441522, 0.23996880498935952, 0.24080542695021862, 0.2416419341701127, 0.24247837384247148, 0.24331375650840803, 0.244147936244523, 0.24498213890556927, 0.2458163906854094, 0.24665046017838585, 0.24748181862975896, 0.2483132551033317, 0.24914355387744153, 0.24997252172357148, 0.25080059836265206, 0.25162864263296403, 0.2524566048636597, 0.25328486281677387, 0.25411343890623456, 0.2549423552203034, 0.2557716335280638, 0.2566012373960372, 0.25743072141368295, 0.2582606311702252, 0.25909098722861246, 0.25992180986150354, 0.2607527930260516, 0.2615837088695182, 0.26241515742325056, 0.2632471578236241, 0.2640796671822586, 0.26491229883884576, 0.2657448741836629, 0.26657436653001265, 0.2674035886348926, 0.2682329911671551, 0.26906273520643653, 0.26989320696107194, 0.27072442331434227, 0.27155609458247787, 0.2723885358131624, 0.273221773005585, 0.27405460534483367, 0.2748868467615394, 0.275719377078016, 0.2765527764622426, 0.2773870597841848, 0.27822224167979975, 0.27905833655143725, 0.27989535856807396, 0.2807322517812876, 0.28157005093939785, 0.2824074464046764, 0.28324283192317284, 0.28407918955612627, 0.28491657349478855, 0.2857537184731212, 0.2865906879125686, 0.28742730176398434, 0.2882646947977603, 0.28910302022957224, 0.289940621418669, 0.2907784855909796, 0.29161723026461395, 0.29245666919108854, 0.2932971605339655, 0.2941385714091796, 0.29498006112038483, 0.2958224334601302, 0.29666598330644045, 0.29750916177465275, 0.2983514900644023, 0.2991931570343365, 0.30003569222134674, 0.30087905324884895, 0.3017236255010777, 0.3025694352725556, 0.30341649018267464, 0.30426465414117904, 0.3051130184316714, 0.30596126599980605, 0.30680917886953746, 0.30765670976128, 0.30850493117348593, 0.30935445713727866, 0.3102052932264972, 0.3110574447459205, 0.31191088289866015, 0.3127651020595012, 0.313620649076048, 0.3144775281635343]
    # H_values_mackey_17_4 = [0.4171975730823765, 0.41653467122377325, 0.41585582217936484, 0.41515812311821343, 0.41444282696832097, 0.41370214050933013, 0.41294488183553557, 0.4121709769919823, 0.4113803818518729, 0.4105650633634447, 0.4097262488695063, 0.4088704849825941, 0.4079982380909459, 0.407109516878769, 0.40620262378466687, 0.4052767172866817, 0.404334529326795, 0.40337429078644566, 0.4023976671819063, 0.40140363404577106, 0.4003919180689601, 0.39936400627462565, 0.39831962857809816, 0.39725500714769996, 0.39616873263061647, 0.39506341857699223, 0.39394593009607, 0.3928118244722405, 0.39166106001617107, 0.3904927868818796, 0.38930857996059764, 0.38810851615548586, 0.3868926791963206, 0.38566115969014686, 0.3844133575644628, 0.3831495712812623, 0.3818704309848918, 0.38057601638917254, 0.37926617423286213, 0.37794135881934615, 0.3766017061779341, 0.37524735809217186, 0.37387846181553647, 0.3724954973576773, 0.3710983122280524, 0.3696865892329244, 0.3682590156838008, 0.3668167914483479, 0.3653590156466883, 0.36388783683288617, 0.36240273484341545, 0.3609037781276675, 0.3595624323285651, 0.3584110863190792, 0.35724157648145616, 0.3560533963610269, 0.3548471641479848, 0.35362389521223325, 0.35238354228762986, 0.35112590265424176, 0.34985200563367685, 0.34856156830641727, 0.34725506510697735, 0.3459330380359362, 0.3445916201298346, 0.34322807340082995, 0.34184808266154376, 0.34045345401848864, 0.3390429539807886, 0.3376170891810984, 0.33617711712101256, 0.3347236074737357, 0.33325523872789686, 0.33177304156636833, 0.3302778720103541, 0.32877007223069404, 0.32724901443840787, 0.32571474454193267, 0.3241670774303549, 0.32260768271706086, 0.32103661893946805, 0.3194528897338374, 0.31785763061549116, 0.31625124856954906, 0.31463411360041055, 0.3130064114958745, 0.3113681573591521, 0.3097192694799693, 0.30805928823125645, 0.30638874237406044, 0.304708542067733, 0.30301789049042266, 0.3013176527258352, 0.29960731092802007, 0.2983947201358448, 0.2974541922076279, 0.29650568925799897, 0.2955499607291644, 0.2945892594386033, 0.29362366378424015, 0.2926532616192463, 0.291677224894813, 0.2906961599794287, 0.2897104175991141, 0.28871621213783766, 0.28771734222572065, 0.28671395847998954, 0.28570611018323755, 0.28469384665283065, 0.2836772171865282, 0.2826562710105415, 0.2816310039787517, 0.28059903863183083, 0.2795562544981316, 0.2785105519192877, 0.2774586639439322, 0.276401674006524, 0.27534055108459987, 0.2742747645609712, 0.27320362238362256, 0.2721272416202783, 0.271045477807835, 0.2699600505479811, 0.2688710037127715, 0.2677783806699119, 0.26668176728022164, 0.26558062468196564, 0.26447513812298296, 0.2633638707999525, 0.26224793082944464, 0.2611284765259831, 0.2600055477212302, 0.25887938168355346, 0.25775001671970815, 0.2566176419280081, 0.2554821776509502, 0.25434361925132454, 0.25320200253971187, 0.252057362760051, 0.25090941463058825, 0.24975771263958949, 0.24860401834510035, 0.24744895651536167, 0.24628927220471866, 0.24512640449350528, 0.24396068431672288, 0.24279119178747624, 0.24161900773230585, 0.2404429350321793, 0.23925641584641844, 0.23806680783834222, 0.2368725686311926, 0.23567460835736387, 0.2344727636106875, 0.23326808829329512, 0.23206070721120386, 0.23085715222307573, 0.22965182661540826, 0.22844318760350155, 0.22723198611834258, 0.22601778844098946, 0.2248001244368745, 0.22358018122477477, 0.22235726065548803, 0.22112996170077065, 0.21990020204295682, 0.21866734269978402, 0.2174318457646003, 0.21619353729093452, 0.2149516816819916, 0.21370740954923706, 0.21246111622527752, 0.21121282371224098, 0.20996171800076957, 0.20870273203731918, 0.20744036345589237, 0.20617396452267142, 0.20490572128606147, 0.20363565496959796, 0.2023634848871737, 0.2010894971236594, 0.1998132518354029, 0.1985351659133142, 0.19725507909342435, 0.19597311257180366, 0.1946892737700818, 0.19340359299082055, 0.1921162890706003, 0.19082738148954445, 0.18953688945285432, 0.18824483186351046, 0.1869512272933153, 0.18565609395248342, 0.18435944965798057, 0.18306131180087515, 0.1817616973129582, 0.180459229677625, 0.1791551556929382, 0.17784772216605998, 0.17653700530262223, 0.1770522863245464, 0.17778837506111245, 0.17852018094749328, 0.1792477674012763, 0.1799711964175089, 0.18069052855880166, 0.18140582294795227, 0.1821167921897853, 0.18282374524759207, 0.1835240632378371, 0.18421843829671855, 0.18490905944502675, 0.185595977581588, 0.18650892855098175, 0.1875356685394777, 0.18855924717715267, 0.1895789017884935, 0.19059523758125604, 0.19160961333957938, 0.19262093439449296, 0.19362985165216717, 0.1946370206214348, 0.1956424555858038, 0.19664617002483045, 0.19764817665615908, 0.19864848747861197, 0.19964711381601816, 0.2006429410096372, 0.20163552200153598, 0.2026257965470586, 0.2036140622263041, 0.20460068869931658, 0.20558534678077858, 0.2065679014554522, 0.20754831688146844, 0.20852566629760114, 0.20949920049091272, 0.21047084637407593, 0.2114400244089778, 0.21240746768462168, 0.21337335664292856, 0.21433769759389154, 0.21530031455213444, 0.2162612569323131, 0.2172206530250388, 0.21817819021193197, 0.2191342155596629, 0.22008873505223786, 0.22104147751229108, 0.2219927107769454, 0.2229424579520882, 0.223890725181843, 0.2248373324703988, 0.22578241960372764, 0.22672531263376355, 0.22766648276445212, 0.22860594937492135, 0.22954378095451966, 0.23048017279624292, 0.231415131715461, 0.2323486646085896, 0.23328077845143383, 0.2342113082686614, 0.2351402964081519, 0.23606782346175317, 0.23699244524769048, 0.2379156802713806, 0.23883753598195684, 0.23975801988338302, 0.24067713952977615, 0.24159490252057128, 0.24251131649555693, 0.2434257937343625, 0.24433416462279725, 0.24524120692447132, 0.2461469282069694, 0.24705131797009963, 0.24795357628582768, 0.24885449463117038, 0.24975412029759278, 0.2506524609265636, 0.25154952414838355, 0.25244526320716554, 0.2533387759567911, 0.2542302038163125, 0.2551192386709808, 0.25600682090409826, 0.2568931610269644, 0.2577782665290223, 0.25866214485387795, 0.2595448033954853, 0.26042624949446413, 0.2613064904345523, 0.2621855334391888, 0.26306338566823306, 0.2639400542148171, 0.26481554610232994, 0.2656898682815385, 0.2665630276278375, 0.2674350309386357]
    # H_values_mackey_17_5 = [0.36125596853507025, 0.3604853510327915, 0.35969540927857324, 0.358885097876233, 0.358050377262484, 0.35719409226225934, 0.3563197521008485, 0.35542134174565737, 0.3545008054837903, 0.3535597085073908, 0.3526011479590885, 0.35163998806488467, 0.35069663327077355, 0.34973992946936283, 0.34876844733275014, 0.3477815392485593, 0.34678276923243595, 0.345766543376536, 0.344739716719211, 0.3437016052328426, 0.34265228379232, 0.3415925373651725, 0.3405236321949026, 0.3394446339516294, 0.33835699910333816, 0.33725992822597534, 0.3361534801395654, 0.33503913568647703, 0.33401867110023953, 0.33304292791034157, 0.33206050400215076, 0.33106782535531143, 0.33006794724963084, 0.32906206445859143, 0.3280491663057199, 0.327022798241645, 0.3259833695492051, 0.3249322181846796, 0.3238721498313822, 0.3228070631553258, 0.3217366749765003, 0.32069464243736867, 0.3196917741867337, 0.31867879648134784, 0.31765726692563145, 0.3166303704710083, 0.3155981612134835, 0.3145541088987463, 0.31350378072184154, 0.31244832648433696, 0.3113878049737826, 0.3103198562051924, 0.3092445820237148, 0.3081628140189118, 0.30707591086945735, 0.305984267340739, 0.3048879507553432, 0.3037870295958657, 0.302678905527072, 0.30156477352297184, 0.3004462697622459, 0.29932346694364415, 0.2981947217198142, 0.297050920044975, 0.29590263998442795, 0.294750458358384, 0.29359417059982434, 0.29242770926355593, 0.29125509245101566, 0.29007875056225174, 0.2888949907557287, 0.2877041364012031, 0.28650730591549906, 0.28530712611148673, 0.28410375548075756, 0.2828926865973259, 0.2816747891662155, 0.2804536609586085, 0.27922778395027986, 0.27799917484672454, 0.27676768996560586, 0.2755303988376947, 0.2742917318138909, 0.27304919923314974, 0.2718035483498952, 0.27055446206792294, 0.2693001304086758, 0.2680415639249505, 0.2667775541596287, 0.26551113466475584, 0.26424186735694527, 0.26295786792435116, 0.26167109489360574, 0.2603822664425312, 0.25909101062214734, 0.25779826152626695, 0.2565037851789472, 0.25520798108861537, 0.25391085529081414, 0.25261108297553214, 0.2513104084160745, 0.25000893155864623, 0.2487067199318805, 0.2474038401710301, 0.24609971938493008, 0.24479435585163173, 0.24348736022192558, 0.24217736669916085, 0.2408670582330282, 0.23955644756479344, 0.23824458200197038, 0.23693532189537678, 0.23565320350029834, 0.23436773771541758, 0.23308210273154134, 0.23179635979310856, 0.23051056692001615, 0.229223734893221, 0.22793637550971627, 0.22664915533728447, 0.22535998089661338, 0.22406988251199722, 0.22277826987424473, 0.22148587897698968, 0.2201934878000104, 0.21890157874384739, 0.2176101988225537, 0.21635192830993583, 0.21512239325887222, 0.2138960860377358, 0.2126696165213813, 0.21144104082749976, 0.2102127808813735, 0.208985025354325, 0.2077578174760153, 0.20653119941523046, 0.20530492921514978, 0.20407934260889113, 0.2028547706817783, 0.20163093853541839, 0.200406763262435, 0.19918323976426455, 0.1979605700623049, 0.1967387116024604, 0.1955168552441633, 0.1942918093534143, 0.19429968665068062, 0.19526535869182562, 0.1962259008182861, 0.197181772974033, 0.19813380562972777, 0.19908188778257377, 0.20002591412852183, 0.2009667331779015, 0.20190261538144902, 0.2028348128633085, 0.20376405511674617, 0.20469041797234688, 0.20561397572413662, 0.206534801162784, 0.20745296560806997, 0.2083685056598746, 0.20928062326024574, 0.21018983642448705, 0.21109550323524623, 0.21199726910797043, 0.2128940786431241, 0.2137861322361037, 0.21467607940272815, 0.21556397962476434, 0.21644972974330143, 0.21733062790281166, 0.2182090502838148, 0.21908562538206106, 0.21996046454326537, 0.22083362065770967, 0.221705145560617, 0.22257442380015927, 0.22344172151662894, 0.22430754110906762, 0.2251719304111454, 0.22603493630811122, 0.22689653968308074, 0.2277566331593232, 0.2286154803291855, 0.22947108288712945, 0.23032427221588742, 0.23117570773232607, 0.23202569678614376, 0.23287467121618946, 0.2337226703664012, 0.23456973280592697, 0.23541578743086844, 0.23626089456036864, 0.23710512111842547, 0.2379481848173707, 0.2387904987135221, 0.23963205796331816, 0.24047254121298042, 0.24131238138156577, 0.2421518940514631, 0.2429894827198038, 0.24382579397566348, 0.2446616135700754, 0.2454969714369903, 0.24633188578694298, 0.2471653037288052, 0.2479970392688688, 0.24882841289714097, 0.24965854167844448, 0.2504881256331646, 0.2513174533960832, 0.25214618270825334, 0.25297438124196076, 0.2538009429516496, 0.25462719156697694, 0.25545251108513445, 0.25627661091716525, 0.25709926141843853, 0.2579212038316005, 0.258741209404537, 0.2595594143088125, 0.2603830740374639, 0.2612083859297954, 0.2620336981809922, 0.2628587365454553, 0.2636835907912246, 0.2645085100976988, 0.265333513720626, 0.2661586205783748, 0.2669838492609258, 0.2678092180387669, 0.2686344425425293, 0.2694594942848735, 0.2702845644109787, 0.2711084338157839, 0.27193247430771644, 0.2727567041674125, 0.2735805969732141, 0.2744047705310326, 0.27522718917632305, 0.2760448077667737, 0.2768627605673164, 0.2776809561357969, 0.2784944492154315, 0.27930831843195447, 0.2801225791031426, 0.2809372463540957, 0.2817523351244239, 0.28256786017532226, 0.28338383609653384, 0.28420073423948006, 0.2850195225059408, 0.285840169018871, 0.2866606420185152, 0.2874816236607089, 0.2883031277482897, 0.2891251679585427, 0.2899469592785576, 0.2907672909348163, 0.2915882149149256, 0.29240974441804884, 0.29323181172725477, 0.2940544513980426, 0.2948775089283209, 0.29570120042110964, 0.2965255595979396, 0.2973505991478717, 0.298176074068524, 0.2989932127659371, 0.2998089164621048, 0.30062541183800556, 0.3014425200165068, 0.30226034058850454, 0.30307899148520745, 0.30389848512634876, 0.30471883388129184, 0.3055400500719061, 0.30636214597525185, 0.3071851338260659, 0.30800902581905365, 0.3088331885208455, 0.30965803874481024, 0.3104834909558769, 0.3113077894719448, 0.3121330695649736, 0.3129588539950463, 0.31378527713511106, 0.31461260689110715, 0.31544097008903677, 0.31627037855076556, 0.31710084406813266, 0.31793220731878663, 0.3187645716989894, 0.3195972677903377, 0.32043085095136953, 0.3212655468385417, 0.3221013670959155, 0.3229383233309057, 0.32377642711245497]

    arr1, arr2, arr3, arr4, arr5 = H_lol[0], H_lol[1], H_lol[2], H_lol[3], H_lol[4]
    optimal_points = {
    'Logmap:r = 3.99, 1': (optimal_q_list[0], optimal_H_list[0]),
    'Logmap:r = 3.99, 2': (optimal_q_list[1], optimal_H_list[1]),
    'Logmap:r = 3.99, 3': (optimal_q_list[2], optimal_H_list[2]),
    'Logmap:r = 3.99, 4': (optimal_q_list[3], optimal_H_list[3]),
    'Logmap:r = 3.99, 5': (optimal_q_list[4], optimal_H_list[4])

    }

    true_hurst_points = {
        'Mackey: tau = 17, 1': [true_list[0], '#1f77b4'],
        'Mackey: tau = 17, 2': [true_list[1], '#ff7f0e'],
        'Mackey: tau = 17, 3': [true_list[2], '#2ca02c'],
        'Mackey: tau = 17, 4': [true_list[3], '#d62728'],
        'Mackey: tau = 17, 5': [true_list[4], '#9467bd']
    }

    # Create a common q_values array
    q_values_common = np.arange(1.1, 1.5, 0.01)
    print(len(q_values_common))



    arr1_adapt = adapt_y_values(np.arange(1.1, 1.5, 0.01), arr1, q_values_common)
    arr2_adapt = adapt_y_values(np.arange(1.1, 1.5, 0.01), arr2, q_values_common)
    arr3_adapt = adapt_y_values(np.arange(1.1, 1.5, 0.01), arr3, q_values_common)
    arr4_adapt = adapt_y_values(np.arange(1.1, 1.5, 0.01), arr4, q_values_common)
    arr5_adapt = adapt_y_values(np.arange(1.1, 1.5, 0.01), arr5, q_values_common)


    plt.figure(figsize=(15, 10))


    plots = [
        (q_values_common, arr1_adapt, 'Logmap:r = 3.99, 1', '-', 'o'),
        (q_values_common, arr2_adapt, 'Logmap:r = 3.99, 2', '-', 's'),
        (q_values_common, arr3_adapt, 'Logmap:r = 3.99, 3', '-', '^'),
        (q_values_common, arr4_adapt, 'Logmap:r = 3.99, 4', ':', 'x'),
        (q_values_common, arr5_adapt, 'Logmap:r = 3.99, 5', ':', '+'),
    ]

    # Store colors to use for optimal values later
    colors = []

    # Plotting
    for q_vals, H_vals, label, linestyle, marker in plots:
        line, = plt.plot(q_vals, H_vals, label=label, linestyle=linestyle, marker=marker, markevery=20)
        colors.append(line.get_color())

    # Additional Plot Settings
    plt.xlabel('q values', fontsize=14)
    plt.ylabel('Hurst Exponent (H)', fontsize=14)
    plt.title('Hurst Exponent (H) vs. q values', fontsize=16)

    # Marking optimal points with corresponding colors
    for idx, (label, (q, h)) in enumerate(optimal_points.items()):
        plt.scatter(q, h, color=colors[idx], s=150, zorder=5)  # zorder to make sure it's on top
    ax = plt.gca()
    max_x_value = 1.55
    plt.axvline(x=max_x_value, color='grey', linestyle='--')
    # Plot the true Hurst exponents on the vertical line
    for label, h in true_hurst_points.items():
        ax.scatter(max_x_value, h[0], color=h[1], zorder=5, marker = 's')
        ax.text(max_x_value, h[0], f'  H={h[0]}', verticalalignment='center')
        ax.axhline(y=h[0], xmin=0, xmax=max_x_value / (max_x_value + 0.1 * (max_x_value - min(q_values_common))), color=h[1], linestyle=':', linewidth=1, alpha=1)

    # Draw the vertical line at the end of the x-axis
    plt.axvline(x=max_x_value, color='grey', linestyle='--')

    # Adjust the x-axis limits to make space for the text
    plt.xlim(min(q_values_common), max_x_value + 0.1 * (max_x_value - min(q_values_common)))

    # Adjusting grid aesthetics
    plt.grid(True, which='both', linestyle='--', linewidth=0.5, alpha=0.7)
    plt.minorticks_on()
    plt.grid(which='major', linestyle='-', linewidth='0.5', color='black', alpha=0.6)
    plt.grid(which='minor', linestyle=':', linewidth='0.5', color='gray', alpha=0.5)

    # Legend specification
    # Add a black marker for the optimal value indication in the legend
    hurst_legend = plt.Line2D([0], [0], marker='o', color='w', label='Fractal UKF Optimal H', markersize=10, markerfacecolor='cyan')
    optimal_legend = plt.Line2D([0], [0], marker='s', color='w', label='True H', markersize=10, markerfacecolor='cyan')
    handles, labels = plt.gca().get_legend_handles_labels()
    handles.append(hurst_legend)
    handles.append(optimal_legend)
    plt.legend(handles=handles, fontsize=10, loc="best")

    # Show the plot
    plt.tight_layout()
    plt.show()


def adapt_y_values(original_q_values, original_y_values, common_q_values):
    adapted_y_values = np.empty_like(common_q_values)
    adapted_y_values[:] = np.NaN  # Fill with NaNs

    # Find indices in the common q_values array where original_q_values starts and ends
    start_idx = np.where(common_q_values >= original_q_values[0])[0][0]
    end_idx = start_idx + len(original_y_values)
    
    adapted_y_values[start_idx:end_idx] = original_y_values
    return adapted_y_values

# H_values_mackey_17_1_adapted = adapt_y_values(np.arange(1.1, 1.5, 0.01), H_values_mackey_17_1, q_values_common)
# H_values_mackey_17_2_adapted = adapt_y_values(np.arange(1.1, 1.5, 0.01), H_values_mackey_17_2, q_values_common)
# H_values_mackey_17_3_adapted = adapt_y_values(np.arange(1.1, 1.5, 0.01), H_values_mackey_17_3, q_values_common)
# H_values_mackey_17_4_adapted = adapt_y_values(np.arange(1.1, 1.5, 0.01), H_values_mackey_17_4, q_values_common)
# H_values_mackey_17_5_adapted = adapt_y_values(np.arange(1.1, 1.5, 0.01), H_values_mackey_17_5, q_values_common)


# plt.figure(figsize=(15, 10))


# plots = [
#     (q_values_common, H_values_mackey_17_1_adapted, 'Mackey:tau = 17, 1', '-', 'o'),
#     (q_values_common, H_values_mackey_17_2_adapted, 'Mackey:tau = 17, 2', '-', 's'),
#     (q_values_common, H_values_mackey_17_3_adapted, 'Mackey:tau = 17, 3', '-', '^'),
#     (q_values_common, H_values_mackey_17_4_adapted, 'Mackey:tau = 17, 4', ':', 'x'),
#     (q_values_common, H_values_mackey_17_5_adapted, 'Mackey:tau = 17, 5', ':', '+'),
# ]

# # Store colors to use for optimal values later
# colors = []

# # Plotting
# for q_vals, H_vals, label, linestyle, marker in plots:
#     line, = plt.plot(q_vals, H_vals, label=label, linestyle=linestyle, marker=marker, markevery=20)
#     colors.append(line.get_color())

# # Additional Plot Settings
# plt.xlabel('q values', fontsize=14)
# plt.ylabel('Hurst Exponent (H)', fontsize=14)
# plt.title('Hurst Exponent (H) vs. q values', fontsize=16)

# # Marking optimal points with corresponding colors
# for idx, (label, (q, h)) in enumerate(optimal_points.items()):
#     plt.scatter(q, h, color=colors[idx], s=150, zorder=5)  # zorder to make sure it's on top
# ax = plt.gca()
# max_x_value = 3.11
# plt.axvline(x=max_x_value, color='grey', linestyle='--')
# # Plot the true Hurst exponents on the vertical line
# for label, h in true_hurst_points.items():
#     ax.scatter(max_x_value, h[0], color=h[1], zorder=5, marker = 's')
#     ax.text(max_x_value, h[0], f'  H={h[0]}', verticalalignment='center')
#     ax.axhline(y=h[0], xmin=0, xmax=max_x_value / (max_x_value + 0.1 * (max_x_value - min(q_values_common))), color=h[1], linestyle=':', linewidth=1, alpha=1)

# # Draw the vertical line at the end of the x-axis
# plt.axvline(x=max_x_value, color='grey', linestyle='--')

# # Adjust the x-axis limits to make space for the text
# plt.xlim(min(q_values_common), max_x_value + 0.1 * (max_x_value - min(q_values_common)))

# # Adjusting grid aesthetics
# plt.grid(True, which='both', linestyle='--', linewidth=0.5, alpha=0.7)
# plt.minorticks_on()
# plt.grid(which='major', linestyle='-', linewidth='0.5', color='black', alpha=0.6)
# plt.grid(which='minor', linestyle=':', linewidth='0.5', color='gray', alpha=0.5)

# # Legend specification
# # Add a black marker for the optimal value indication in the legend
# hurst_legend = plt.Line2D([0], [0], marker='o', color='w', label='Fractal UKF Optimal H', markersize=10, markerfacecolor='cyan')
# optimal_legend = plt.Line2D([0], [0], marker='s', color='w', label='True H', markersize=10, markerfacecolor='cyan')
# handles, labels = plt.gca().get_legend_handles_labels()
# handles.append(hurst_legend)
# handles.append(optimal_legend)
# plt.legend(handles=handles, fontsize=10, loc="best")

# # Show the plot
# plt.tight_layout()
# plt.show()





